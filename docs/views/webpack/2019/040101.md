---
title: webpack基础知识整理
date: 2019-04-01
tags:
 - webpack       
categories: webpack
---

## webpack简介

webpack是一个 **模块打包工具**，支持所有的打包语法，比如 `ES Module`、`CommonJS`、`CMD`、`AMD`。初期的webpack是用来模块打包js的，发展到现在，已经可以打包很多种文件类型，比如 `css`、`img` 。

优化打包速度最有效的方法就是保持 `nodejs` 和 `webpack` 为最新版本。

## 安装

安装 `webpack` 建议根据项目安装而不是全局安装，可以使用以下命令：

```bash
npm install webpack webpack-cli --save-dev

# 或

yarn add webpack webpack-cli --dev
```

这个时候执行 `webpack -v` 是查不到版本号的，因为 `nodejs` 默认是去全局找 `webpack`，这个时候是找不到的，nodejs还提供了 `npx webpack -v` 这个方法。

## 运行

如果不生成配置文件，webpack会按照默认配置去打包，如果我们想自定义配置文件可以在项目根目录添加 `webpack.config.js` 来自定义配置信息，配置文件的名字也可以自定义：

```bash
# 默认配置或者默认配置文件
npx webpack

# 自定义配置并且修改默认配置名字
npx webpack --config my-webpack-config.js

# npm scripts 中配置 "build": "webpack"
npm run build
```

一个简单的配置：

```js
module.exports = {
  mode: 'production', // production：默认，生产环境，代码被压缩；development：开发环境，代码不压缩
  entry: './src/index.js',
  output: {
    filename: 'bundle.js',
    path: path.resolve(__dirname, 'dist')
  }
}
```

其中 `entry` 可以写成这样：

```js
entry: {
  main: './src/index.js'
}
```

其实，开始安装的 `webpack-cli` 就是为了在命令行工具中可以正确地执行命令行工具。

## loader

`webpack` 可以使用 `loader` 来预处理文件。这允许你打包除 `JavaScript` 之外的任何静态资源，js的打包是webpack内置的。你可以使用 `Node.js` 来很简单地编写自己的 `loader`。

```js
const path = require('path')

module.exports = {
  mode: 'production',
  entry: './src/index.js',
  output: {
    filename: 'main.js',
    path: path.resolve(__dirname, 'dist')
  },
  module: {
    rules: [
      {
        test: /\.jpg$/,
        use: {
          loader: 'file-loader'
        }
      }
    ]
  }
}
```