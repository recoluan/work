---
title: 前端知识汇总（十）——JS运行机制
date: 2019-03-13
tags:
 - interview        
categories: interview
---

:::tip 目录
- 单线程
- 任务队列
- Event Loop
- 异步任务有哪些
:::

## 单线程

js同一时间只能做一件事

## 任务队列

js的任务队列分为同步任务和异步任务，异步任务要考虑放入时间和执行时间。

**案例1**

```js
console.log(1)
setTimeout(() => {
  console.log(2)
}, 0)
console.log(3)

// 打印顺序 1, 3, 2
```

因为setTimeout是异步任务，会放到异步队列中去，所以先执行同步任务，所以2会最后才打印。

**案例2**

```js
console.log(1)
setTimeout(() => {
  console.log(2)
}, 0)
while (1) {

}

// 打印顺序 1
```

由于while是一个同步任务，浏览器会一直等待它执行完成，所以打印完1后，会一直处于加载状态。

**案例3**

```js
for (var i = 0; i< 4; i++) {
  setTimeout(() => {
    console.log(i)
  }, i * 1000)
}

// 打印 4个4
```

```js
for (let i = 0; i< 4; i++) {
  setTimeout(() => {
    console.log(i)
  }, i * 1000)
}

// 打印 0, 1, 2, 3   因为let不存在变量提升
```

## Event Loop

1. 浏览器的js执行站是执行的是同步任务；
2. 执行过程中遇到异步任务，会拿出去保存起来，到了延迟的时间（比如setTimeout所以指定的时间），放到异步队列中；
3. 同步任务执行完后，会监听异步队列，如果异步队列中有内容，就放在同步任务中，继续执行；
4. 执行完后，重复第3步。

## 异步任务有哪些

1. setTimeout 和 setInterval
2. DOM 事件：比如当我点击某个按钮去触发某个事件，并没有立即去触发，而是先放到异步队列中，等待同步任务执行完毕后再去执行
3. Promise